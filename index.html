<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Calculator Hub</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for aesthetic */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f9fb;
        }
        .card {
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        .input-group label {
            font-weight: 500;
        }
        /* Custom styles for tabs */
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            color: #4b5563; /* gray-600 */
            white-space: nowrap;
        }
        .tab.active {
            border-bottom-color: #3b82f6; /* blue-500 */
            color: #1e40af; /* blue-800 */
            font-weight: 600;
        }
        #calculator-tabs {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            justify-content: flex-start;
        }
    </style>
</head>
<body class="p-4 sm:p-8 flex justify-center items-start min-h-screen">

    <div id="calculator-app" class="w-full max-w-5xl">
        
        <!-- ============================================== -->
        <!-- 1. HOME SCREEN (Visible by default) -->
        <!-- ============================================== -->
        <div id="home-view" class="active-view">
            <header class="text-center mb-12">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-blue-800 mb-2">Physics Tools Hub</h1>
                <p class="text-xl text-gray-600">Select a calculator to begin.</p>
            </header>

            <div class="grid md:grid-cols-2 gap-8">
                
                <!-- Simple Machine Calculator Card -->
                <div id="select-simple-machine" class="card bg-white p-8 rounded-xl border border-blue-200 cursor-pointer hover:shadow-xl hover:bg-blue-50 transition duration-300 transform hover:scale-[1.02]">
                    <div class="flex items-center space-x-4">
                        <svg class="w-10 h-10 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
                        </svg>
                        <div>
                            <h2 class="text-2xl font-bold text-blue-800">Simple Machine Analysis</h2>
                            <p class="text-gray-600">Analyze the IMA, AMA, and Efficiency of the six simple machines.</p>
                        </div>
                    </div>
                </div>

                <!-- Placeholder for another calculator -->
                <div class="card bg-gray-100 p-8 rounded-xl border border-gray-300 opacity-60">
                    <div class="flex items-center space-x-4">
                         <svg class="w-10 h-10 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c1.657 0 3 .895 3 2s-1.343 2-3 2h-1a2 2 0 00-2 2v1m-4 1h5.5M15 4a6 6 0 00-6 6v3h2a3 3 0 110 6h-3M3 12l3-3m0 0l-3-3m3 3h12"></path>
                        </svg>
                        <div>
                            <h2 class="text-2xl font-bold text-gray-700">Kinematics Calculator (Coming Soon)</h2>
                            <p class="text-gray-500">Solve $v, d, a, t$ equations.</p>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- ============================================== -->
        <!-- 2. SIMPLE MACHINE CALCULATOR VIEW (Hidden initially) -->
        <!-- ============================================== -->
        <div id="simple-machine-calculator-view" class="hidden">
            
            <!-- Back Button -->
            <button id="back-to-home-btn" class="mb-6 px-4 py-2 bg-gray-200 text-gray-700 font-medium rounded-lg hover:bg-gray-300 transition duration-200 flex items-center">
                <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg>
                Back to Home
            </button>
            
            <header class="text-center mb-6">
                <h1 class="text-3xl sm:text-4xl font-extrabold text-blue-800">Simple Machine Analysis Hub</h1>
                <p class="text-lg text-gray-600 mt-2">
                    Calculate IMA, AMA, and Efficiency ($\eta$) for specific machines.
                </p>
            </header>
            
            <!-- Tab Navigation -->
            <div id="calculator-tabs" class="flex border-b border-gray-300 mb-6">
                <div class="tab active" data-tab="general">General Solver</div>
                <div class="tab" data-tab="lever">Lever</div>
                <div class="tab" data-tab="wheel-axle">Wheel & Axle</div>
                <div class="tab" data-tab="pulley">Pulley</div>
                <div class="tab" data-tab="inclined-plane">Inclined Plane</div>
                <div class="tab" data-tab="wedge">Wedge</div>
                <div class="tab" data-tab="screw">Screw</div>
            </div>

            <!-- Tab Content Containers -->
            <div id="tab-content" class="bg-white p-6 rounded-xl card border border-gray-200">
                
                <!-- Helper for machine-specific tabs -->
                <div class="machine-message-box p-3 rounded-lg text-sm hidden mb-4" role="alert"></div>

                <!-- 1. GENERAL ANALYSIS (The 5-Variable Solver) -->
                <div id="content-general" class="tab-pane active-pane">
                    <p class="text-sm text-gray-500 mb-4 p-2 rounded-lg bg-gray-100">
                        Enter **exactly four** of the five primary variables ($F_e, D_e, F_r, D_r, \eta$) to solve for the missing one.
                    </p>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <!-- General Input Fields -->
                        <div id="general-inputs" class="grid grid-cols-2 gap-6">
                            <!-- Fe -->
                            <div class="input-group">
                                <label for="Fe_gen" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_gen" placeholder="e.g. 50" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force (N/lb)</p>
                            </div>
                            <!-- De -->
                            <div class="input-group">
                                <label for="De_gen" class="block text-sm text-gray-700">Effort Distance ($D_e$)</label>
                                <input type="number" id="De_gen" placeholder="e.g. 2.5" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/ft)</p>
                            </div>
                            <!-- Fr -->
                            <div class="input-group">
                                <label for="Fr_gen" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_gen" placeholder="e.g. 150" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force (N/lb)</p>
                            </div>
                            <!-- Dr -->
                            <div class="input-group">
                                <label for="Dr_gen" class="block text-sm text-gray-700">Resistance Distance ($D_r$)</label>
                                <input type="number" id="Dr_gen" placeholder="e.g. 0.5" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/ft)</p>
                            </div>
                            <!-- Efficiency -->
                            <div class="input-group col-span-2">
                                <label for="Eff_gen" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_gen" placeholder="e.g. 67 (for 67%)" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>

                        <!-- General Output Fields -->
                        <div id="general-outputs">
                            <h2 class="text-xl font-semibold mb-6 text-gray-700">2. Calculated Results</h2>
                            <div class="space-y-4">
                                <!-- Missing Value Output -->
                                <div class="p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded-lg">
                                    <p class="text-sm font-medium text-gray-800">Missing Variable ($X$): <span id="output-missing-name-gen" class="font-bold text-yellow-700">N/A</span></p>
                                    <p class="text-lg font-bold text-yellow-700"><span id="output-missing-value-gen">--</span></p>
                                </div>
                                <!-- IMA Output -->
                                <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded-lg">
                                    <p class="text-sm font-medium text-gray-800">Ideal Mechanical Advantage (IMA):</p>
                                    <p class="text-lg font-bold text-blue-700"><span id="output-IMA-gen">--</span></p>
                                    <p class="text-xs text-gray-500 mt-1">Formula: $IMA = D_e / D_r$</p>
                                </div>
                                <!-- AMA Output -->
                                <div class="p-4 bg-green-50 border-l-4 border-green-500 rounded-lg">
                                    <p class="text-sm font-medium text-gray-800">Actual Mechanical Advantage (AMA):</p>
                                    <p class="text-lg font-bold text-green-700"><span id="output-AMA-gen">--</span></p>
                                    <p class="text-xs text-gray-500 mt-1">Formula: $AMA = F_r / F_e$</p>
                                </div>
                                <!-- Efficiency Output -->
                                <div class="p-4 bg-indigo-50 border-l-4 border-indigo-500 rounded-lg">
                                    <p class="text-sm font-medium text-gray-800">Efficiency ($\eta$):</p>
                                    <p class="text-lg font-bold text-indigo-700"><span id="output-Efficiency-gen">--</span></p>
                                    <p class="text-xs text-gray-500 mt-1">Formula: $\eta = (AMA / IMA) \times 100\%$</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="mt-8 flex space-x-4">
                        <button id="calculate-btn-gen" class="flex-1 px-6 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300">
                            Calculate Results
                        </button>
                        <button id="clear-btn-gen" class="px-6 py-3 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition duration-200 focus:outline-none focus:ring-4 focus:ring-gray-400">
                            Clear
                        </button>
                    </div>
                    <div id="message-box-gen" class="mt-4 p-3 rounded-lg text-sm text-red-700 bg-red-100 hidden" role="alert"></div>
                </div>

                <!-- 2. LEVER CALCULATOR -->
                <div id="content-lever" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Lever Analysis (IMA: $L_e / L_r$)</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="lever">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="De_lev" class="block text-sm text-gray-700">Effort Arm Length ($L_e$)</label>
                                <input type="number" id="De_lev" placeholder="e.g. 5" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance</p>
                            </div>
                            <div class="input-group">
                                <label for="Dr_lev" class="block text-sm text-gray-700">Resistance Arm Length ($L_r$)</label>
                                <input type="number" id="Dr_lev" placeholder="e.g. 1" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_lev" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_lev" placeholder="e.g. 200" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_lev" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_lev" placeholder="e.g. 800" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_lev" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_lev" placeholder="e.g. 80 (for 80%)" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="lever-outputs"></div>
                    </div>
                </div>

                <!-- 3. WHEEL & AXLE CALCULATOR -->
                <div id="content-wheel-axle" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Wheel & Axle Analysis (IMA: $R_{wheel} / R_{axle}$)</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="wheel-axle">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="De_wa" class="block text-sm text-gray-700">Radius of Wheel ($R_{wheel}$)</label>
                                <input type="number" id="De_wa" placeholder="e.g. 0.5" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/cm)</p>
                            </div>
                            <div class="input-group">
                                <label for="Dr_wa" class="block text-sm text-gray-700">Radius of Axle ($R_{axle}$)</label>
                                <input type="number" id="Dr_wa" placeholder="e.g. 0.1" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/cm)</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_wa" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_wa" placeholder="e.g. 50" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_wa" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_wa" placeholder="e.g. 200" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_wa" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_wa" placeholder="e.g. 75" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="wheel-axle-outputs"></div>
                    </div>
                </div>

                <!-- 4. PULLEY CALCULATOR -->
                <div id="content-pulley" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Pulley Analysis (IMA: Number of Supporting Ropes)</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="pulley">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="Ima_pul" class="block text-sm text-gray-700">Number of Supporting Ropes ($N$)</label>
                                <input type="number" id="Ima_pul" placeholder="e.g. 4" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Count (This is the IMA)</p>
                            </div>
                            <div class="input-group">
                                <label class="block text-sm text-gray-700">D_r (Resistance Distance)</label>
                                <input type="number" disabled value="1" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed">
                                <p class="text-xs text-gray-500 mt-1">IMA calculation uses $D_r = 1$ for rope distance.</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_pul" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_pul" placeholder="e.g. 100" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_pul" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_pul" placeholder="e.g. 350" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_pul" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_pul" placeholder="e.g. 87.5" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="pulley-outputs"></div>
                    </div>
                </div>
                
                <!-- 5. INCLINED PLANE CALCULATOR -->
                <div id="content-inclined-plane" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Inclined Plane Analysis (IMA: $L / h$)</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="inclined-plane">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="De_ip" class="block text-sm text-gray-700">Incline Length ($L$)</label>
                                <input type="number" id="De_ip" placeholder="e.g. 10" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/ft)</p>
                            </div>
                            <div class="input-group">
                                <label for="Dr_ip" class="block text-sm text-gray-700">Vertical Height ($h$)</label>
                                <input type="number" id="Dr_ip" placeholder="e.g. 2" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/ft)</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_ip" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_ip" placeholder="e.g. 25" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_ip" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_ip" placeholder="e.g. 100" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_ip" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_ip" placeholder="e.g. 80" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="inclined-plane-outputs"></div>
                    </div>
                </div>

                <!-- 6. WEDGE CALCULATOR -->
                <div id="content-wedge" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Wedge Analysis (IMA: $L / t$)</h3>
                    <p class="text-sm text-gray-500 mb-4">Note: The IMA calculation for a wedge is often theoretical and may not reflect real-world friction. Use the general analysis for complex scenarios.</p>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="wedge">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="De_wed" class="block text-sm text-gray-700">Wedge Length ($L$)</label>
                                <input type="number" id="De_wed" placeholder="e.g. 15" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (in/cm)</p>
                            </div>
                            <div class="input-group">
                                <label for="Dr_wed" class="block text-sm text-gray-700">Wedge Thickness ($t$)</label>
                                <input type="number" id="Dr_wed" placeholder="e.g. 3" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (in/cm)</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_wed" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_wed" placeholder="e.g. 500" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_wed" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_wed" placeholder="e.g. 2000" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_wed" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_wed" placeholder="e.g. 70" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="wedge-outputs"></div>
                    </div>
                </div>

                <!-- 7. SCREW CALCULATOR -->
                <div id="content-screw" class="tab-pane hidden">
                    <h3 class="text-xl font-bold text-blue-700 mb-4">Screw Analysis (IMA: $2\pi r / p$)</h3>
                    <div class="grid lg:grid-cols-2 gap-8">
                        <div class="grid grid-cols-2 gap-6 machine-inputs" data-machine="screw">
                            <!-- IMA Specific Inputs -->
                            <div class="input-group">
                                <label for="r_scr" class="block text-sm text-gray-700">Effort Radius ($r$) (Handle Length)</label>
                                <input type="number" id="r_scr" placeholder="e.g. 0.2" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/cm)</p>
                            </div>
                            <div class="input-group">
                                <label for="p_scr" class="block text-sm text-gray-700">Pitch ($p$) (Thread Distance)</label>
                                <input type="number" id="p_scr" placeholder="e.g. 0.005" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Distance (m/cm)</p>
                            </div>
                            <!-- AMA/Effort Inputs (3, one must be empty) -->
                            <div class="input-group">
                                <label for="Fe_scr" class="block text-sm text-gray-700">Effort Force ($F_e$)</label>
                                <input type="number" id="Fe_scr" placeholder="e.g. 10" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group">
                                <label for="Fr_scr" class="block text-sm text-gray-700">Resistance Force ($F_r$)</label>
                                <input type="number" id="Fr_scr" placeholder="e.g. 1500" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Force</p>
                            </div>
                            <div class="input-group col-span-2">
                                <label for="Eff_scr" class="block text-sm text-gray-700">Efficiency ($\eta$)</label>
                                <input type="number" id="Eff_scr" placeholder="e.g. 30" class="input-field mt-1 block w-full px-3 py-2 border border-gray-300 rounded-lg">
                                <p class="text-xs text-gray-500 mt-1">Unit: Percentage (0-100)</p>
                            </div>
                        </div>
                        <div id="screw-outputs"></div>
                    </div>
                </div>

                <!-- Shared Calculation/Clear Buttons and Message Box for Machine-Specific Tabs -->
                <div id="shared-controls" class="mt-8 flex space-x-4">
                    <button id="calculate-btn-machine" class="flex-1 px-6 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition duration-200 focus:outline-none focus:ring-4 focus:ring-blue-300">
                        Calculate Machine Results
                    </button>
                    <button id="clear-btn-machine" class="px-6 py-3 bg-gray-200 text-gray-700 font-bold rounded-lg hover:bg-gray-300 transition duration-200 focus:outline-none focus:ring-4 focus:ring-gray-400">
                        Clear Inputs
                    </button>
                </div>

            </div>
            
        </div>

        <footer class="mt-10 text-center text-sm text-gray-500">
            <p>Formulas: $IMA$ is machine-specific; $AMA = F_r / F_e$; $\eta = (AMA / IMA) \times 100\%$.</p>
        </footer>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- Global Utility Functions ---
            
            const messageBoxGen = document.getElementById('message-box-gen');
            const machineMessageBox = document.querySelector('.machine-message-box');

            const showMessage = (box, text, isError = true) => {
                box.textContent = text;
                box.classList.remove('hidden');
                if (isError) {
                    box.classList.remove('bg-green-100', 'text-green-700');
                    box.classList.add('bg-red-100', 'text-red-700');
                } else {
                    box.classList.remove('bg-red-100', 'text-red-700');
                    box.classList.add('bg-green-100', 'text-green-700');
                }
            };

            const clearMessage = (box) => {
                box.classList.add('hidden');
                box.textContent = '';
            };

            const formatResult = (value) => {
                if (isNaN(value)) return '--';
                if (value === Infinity) return 'Infinite';
                return value.toFixed(4);
            }
            
            // --- View Management Logic (Home vs Calculator) ---
            const homeView = document.getElementById('home-view');
            const simpleMachineView = document.getElementById('simple-machine-calculator-view');
            const selectSimpleMachineBtn = document.getElementById('select-simple-machine');
            const backToHomeBtn = document.getElementById('back-to-home-btn');
            let activeTab = 'general';

            const showScreen = (screenId) => {
                homeView.classList.add('hidden');
                simpleMachineView.classList.add('hidden');

                if (screenId === 'home') {
                    homeView.classList.remove('hidden');
                } else if (screenId === 'simpleMachine') {
                    simpleMachineView.classList.remove('hidden');
                }
            };
            
            showScreen('home'); 

            selectSimpleMachineBtn.addEventListener('click', () => {
                showScreen('simpleMachine');
                switchTab('general'); // Always start on the general solver
            });
            backToHomeBtn.addEventListener('click', () => showScreen('home'));


            // --- Tab Switching Logic (Within Simple Machine Calculator) ---
            const tabs = document.querySelectorAll('#calculator-tabs .tab');
            const tabPanes = document.querySelectorAll('#tab-content .tab-pane');

            const switchTab = (tabId) => {
                activeTab = tabId;
                tabs.forEach(tab => {
                    tab.classList.remove('active');
                    if (tab.getAttribute('data-tab') === tabId) {
                        tab.classList.add('active');
                    }
                });

                tabPanes.forEach(pane => {
                    pane.classList.add('hidden');
                    pane.classList.remove('active-pane');
                    if (pane.id === `content-${tabId}`) {
                        pane.classList.remove('hidden');
                        pane.classList.add('active-pane');
                    }
                });
                
                // Show/Hide machine controls based on tab
                const controls = document.getElementById('shared-controls');
                if (tabId === 'general') {
                    controls.classList.add('hidden');
                    messageBoxGen.classList.remove('hidden');
                    machineMessageBox.classList.add('hidden');
                } else {
                    controls.classList.remove('hidden');
                    messageBoxGen.classList.add('hidden');
                    machineMessageBox.classList.remove('hidden');
                }
                clearMessage(machineMessageBox);
            };

            tabs.forEach(tab => {
                tab.addEventListener('click', (e) => {
                    switchTab(e.target.getAttribute('data-tab'));
                });
            });

            // --- Template for Machine-Specific Outputs ---
            const createOutputHTML = (machineName) => {
                return `
                    <h2 class="text-xl font-semibold mb-6 text-gray-700">Calculated Results</h2>
                    <div class="space-y-4">
                        <div class="p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded-lg">
                            <p class="text-sm font-medium text-gray-800">Missing Variable: <span id="output-missing-name-${machineName}" class="font-bold text-yellow-700">N/A</span></p>
                            <p class="text-lg font-bold text-yellow-700"><span id="output-missing-value-${machineName}">--</span></p>
                        </div>
                        <div class="p-4 bg-blue-50 border-l-4 border-blue-500 rounded-lg">
                            <p class="text-sm font-medium text-gray-800">Ideal Mechanical Advantage (IMA):</p>
                            <p class="text-lg font-bold text-blue-700"><span id="output-IMA-${machineName}">--</span></p>
                            <p class="text-xs text-gray-500 mt-1">Formula: Machine Specific</p>
                        </div>
                        <div class="p-4 bg-green-50 border-l-4 border-green-500 rounded-lg">
                            <p class="text-sm font-medium text-gray-800">Actual Mechanical Advantage (AMA):</p>
                            <p class="text-lg font-bold text-green-700"><span id="output-AMA-${machineName}">--</span></p>
                            <p class="text-xs text-gray-500 mt-1">Formula: $AMA = F_r / F_e$</p>
                        </div>
                        <div class="p-4 bg-indigo-50 border-l-4 border-indigo-500 rounded-lg">
                            <p class="text-sm font-medium text-gray-800">Efficiency ($\eta$):</p>
                            <p class="text-lg font-bold text-indigo-700"><span id="output-Efficiency-${machineName}">--</span></p>
                            <p class="text-xs text-gray-500 mt-1">Formula: $\eta = (AMA / IMA) \times 100\%$</p>
                        </div>
                    </div>
                `;
            };

            // Initialize machine output divs
            ['lever', 'wheel-axle', 'pulley', 'inclined-plane', 'wedge', 'screw'].forEach(machine => {
                document.getElementById(`${machine}-outputs`).innerHTML = createOutputHTML(machine);
            });


            // --- Core Machine-Specific Calculation Logic ---

            const calculateMachineSpecific = (machine) => {
                clearMessage(machineMessageBox);

                // --- 1. Get Inputs (IDs are unique but follow a pattern) ---
                const machineInputs = {
                    Fe: parseFloat(document.getElementById(`Fe_${machine.slice(0, 3)}`).value),
                    Fr: parseFloat(document.getElementById(`Fr_${machine.slice(0, 3)}`).value),
                    Eff: parseFloat(document.getElementById(`Eff_${machine.slice(0, 3)}`).value),
                    // De and Dr (renamed for specific machines)
                    Dim1: parseFloat(document.getElementById(`De_${machine.slice(0, 3)}`).value) || parseFloat(document.getElementById(`Ima_${machine.slice(0, 3)}`).value) || parseFloat(document.getElementById(`r_${machine.slice(0, 3)}`).value),
                    Dim2: parseFloat(document.getElementById(`Dr_${machine.slice(0, 3)}`).value) || parseFloat(document.getElementById(`p_${machine.slice(0, 3)}`).value),
                };

                const v = machineInputs;
                let calculatedIMA = NaN;
                let AMA = NaN;
                let calculatedValue = NaN;
                let missingVariable = null;

                // --- 2. Calculate IMA based on Machine Type ---
                try {
                    if (machine === 'lever' || machine === 'wheel-axle' || machine === 'inclined-plane' || machine === 'wedge') {
                        // IMA = Dim1 / Dim2 (L_e/L_r, R_wheel/R_axle, L_incline/h, L_wedge/t)
                        if (isNaN(v.Dim1) || isNaN(v.Dim2) || v.Dim2 === 0) {
                            throw new Error('Please enter valid dimensions for IMA (must be non-zero).');
                        }
                        calculatedIMA = v.Dim1 / v.Dim2;
                    } else if (machine === 'pulley') {
                        // IMA = N (Number of Ropes)
                        if (isNaN(v.Dim1) || v.Dim1 <= 0) {
                            throw new Error('Please enter a valid number of supporting ropes (N > 0).');
                        }
                        calculatedIMA = v.Dim1;
                    } else if (machine === 'screw') {
                        // IMA = 2 * pi * r / p
                        if (isNaN(v.Dim1) || isNaN(v.Dim2) || v.Dim2 === 0) {
                            throw new Error('Please enter valid Effort Radius and Pitch (Pitch must be non-zero).');
                        }
                        calculatedIMA = (2 * Math.PI * v.Dim1) / v.Dim2;
                    }
                } catch (e) {
                    showMessage(machineMessageBox, 'IMA Error: ' + e.message);
                    return;
                }

                // --- 3. Identify and Solve for the Missing Force/Efficiency Variable ---
                const variables = { Fe: v.Fe, Fr: v.Fr, Eff: v.Eff };
                const definedCount = Object.keys(variables).filter(key => !isNaN(variables[key])).length;
                
                if (definedCount !== 2) {
                    showMessage(machineMessageBox, 'Calculation Error: IMA is set, but you must enter **exactly two** of the three remaining variables ($F_e, F_r, \eta$). You entered ' + definedCount + '.');
                    return;
                }
                
                // Find the missing variable
                const allVars = ['Fe', 'Fr', 'Eff'];
                missingVariable = allVars.find(key => isNaN(variables[key]));

                if (missingVariable === 'Fe') {
                    // Solve for Fe: Fe = Fr / AMA -> Fe = Fr / (Eff/100 * IMA)
                    AMA = (v.Eff / 100) * calculatedIMA;
                    if (AMA === 0) throw new Error('AMA is zero. Cannot solve $F_e$.');
                    calculatedValue = v.Fr / AMA;
                    v.Fe = calculatedValue;

                } else if (missingVariable === 'Fr') {
                    // Solve for Fr: Fr = Fe * AMA -> Fr = Fe * (Eff/100 * IMA)
                    AMA = (v.Eff / 100) * calculatedIMA;
                    calculatedValue = v.Fe * AMA;
                    v.Fr = calculatedValue;

                } else if (missingVariable === 'Eff') {
                    // Solve for Eff: Eff = (AMA / IMA) * 100
                    AMA = v.Fr / v.Fe;
                    calculatedValue = (AMA / calculatedIMA) * 100;
                    v.Eff = calculatedValue;

                } else {
                    // Should be caught by definedCount check, but for safety
                    showMessage(machineMessageBox, 'Logic Error: Could not isolate the single missing variable.');
                    return;
                }
                
                // --- 4. Final Output Calculations ---
                
                // Final AMA
                const finalAMA = v.Fe === 0 ? Infinity : (v.Fr / v.Fe);
                
                // Final Efficiency
                let finalEff = NaN;
                if (calculatedIMA > 0 && calculatedIMA !== Infinity && finalAMA !== Infinity) {
                    finalEff = (finalAMA / calculatedIMA) * 100;
                }


                // --- 5. Display Results ---
                const outputMachineName = machine.replace(/-/g, '_');
                const outputIDs = {
                    missingName: document.getElementById(`output-missing-name-${outputMachineName}`),
                    missingValue: document.getElementById(`output-missing-value-${outputMachineName}`),
                    IMA: document.getElementById(`output-IMA-${outputMachineName}`),
                    AMA: document.getElementById(`output-AMA-${outputMachineName}`),
                    Efficiency: document.getElementById(`output-Efficiency-${outputMachineName}`),
                };
                
                const missingNameMap = {
                    Fe: 'Effort Force ($F_e$)',
                    Fr: 'Resistance Force ($F_r$)',
                    Eff: 'Efficiency ($\eta$)',
                };

                outputIDs.missingName.textContent = missingNameMap[missingVariable];
                outputIDs.missingValue.textContent = formatResult(calculatedValue);
                outputIDs.IMA.textContent = formatResult(calculatedIMA);
                outputIDs.AMA.textContent = formatResult(finalAMA);
                outputIDs.Efficiency.textContent = finalEff === Infinity ? 'Infinite' : (isNaN(finalEff) ? '--' : finalEff.toFixed(2) + ' %');

                if (finalEff > 100) {
                    showMessage(machineMessageBox, `Warning: Calculated efficiency is ${finalEff.toFixed(2)}%. This is physically impossible and indicates an error in your input forces or distances.`, false);
                } else {
                    showMessage(machineMessageBox, `Calculation successful!`, false);
                }
            };
            
            // --- Event Listeners for Machine-Specific Tabs ---
            document.getElementById('calculate-btn-machine').addEventListener('click', () => {
                if (activeTab && activeTab !== 'general') {
                    calculateMachineSpecific(activeTab);
                }
            });

            document.getElementById('clear-btn-machine').addEventListener('click', () => {
                if (activeTab && activeTab !== 'general') {
                    const inputs = document.querySelectorAll(`#content-${activeTab} .input-field`);
                    inputs.forEach(input => input.value = '');
                    // Clear outputs
                    const machineName = activeTab.replace(/-/g, '_');
                    const outputIDs = {
                        missingName: document.getElementById(`output-missing-name-${machineName}`),
                        missingValue: document.getElementById(`output-missing-value-${machineName}`),
                        IMA: document.getElementById(`output-IMA-${machineName}`),
                        AMA: document.getElementById(`output-AMA-${machineName}`),
                        Efficiency: document.getElementById(`output-Efficiency-${machineName}`),
                    };
                    Object.values(outputIDs).forEach(el => el.textContent = '--');
                    outputIDs.missingName.textContent = 'N/A';
                    clearMessage(machineMessageBox);
                }
            });


            // --- General Calculator Logic (Copied from previous step) ---
            
            // Get all input and output elements for General Solver
            const inputsGen = {
                Fe: document.getElementById('Fe_gen'),
                De: document.getElementById('De_gen'),
                Fr: document.getElementById('Fr_gen'),
                Dr: document.getElementById('Dr_gen'),
                Eff: document.getElementById('Eff_gen'), // Efficiency input
            };

            const outputNamesGen = {
                Fe: 'Effort Force ($F_e$)',
                De: 'Effort Distance ($D_e$)',
                Fr: 'Resistance Force ($F_r$)',
                Dr: 'Resistance Distance ($D_r$)',
                Eff: 'Efficiency ($\eta$)',
            };

            const outputsGen = {
                missingName: document.getElementById('output-missing-name-gen'),
                missingValue: document.getElementById('output-missing-value-gen'),
                IMA: document.getElementById('output-IMA-gen'),
                AMA: document.getElementById('output-AMA-gen'),
                Efficiency: document.getElementById('output-Efficiency-gen'),
            };

            const calculateBtnGen = document.getElementById('calculate-btn-gen');
            const clearBtnGen = document.getElementById('clear-btn-gen');

            const clearOutputsGen = () => {
                outputsGen.missingName.textContent = 'N/A';
                outputsGen.missingValue.textContent = '--';
                outputsGen.IMA.textContent = '--';
                outputsGen.AMA.textContent = '--';
                outputsGen.Efficiency.textContent = '--';
                clearMessage(messageBoxGen);
            };

            const calculateGeneral = () => {
                clearOutputsGen(); 

                // 1. Collect and validate input values
                const rawValues = {
                    Fe: parseFloat(inputsGen.Fe.value),
                    De: parseFloat(inputsGen.De.value),
                    Fr: parseFloat(inputsGen.Fr.value),
                    Dr: parseFloat(inputsGen.Dr.value),
                    Eff: parseFloat(inputsGen.Eff.value), // Efficiency in percentage (0-100)
                };

                const allVars = Object.keys(rawValues);
                const definedVariables = allVars.filter(key => !isNaN(rawValues[key]) && rawValues[key] !== null);
                const missingVariable = allVars.find(key => isNaN(rawValues[key]) || rawValues[key] === null);

                if (definedVariables.length !== 4) {
                    showMessage(messageBoxGen, 'Please enter **exactly four** of the five available values ($F_e, D_e, F_r, D_r, \eta$). You entered ' + definedVariables.length + '.');
                    return;
                }
                
                // Efficiency check
                if (!isNaN(rawValues.Eff) && (rawValues.Eff > 100 || rawValues.Eff < 0)) {
                    showMessage(messageBoxGen, 'Efficiency ($\eta$) must be between 0 and 100.', true);
                    return;
                }
                
                let calculatedValue = NaN;
                let AMA = NaN;
                let IMA = NaN;
                const v = rawValues; // Shorthand for values
                
                try {
                    // A. Calculate IMA (requires D_e and D_r)
                    if (!isNaN(v.De) && !isNaN(v.Dr)) {
                        IMA = v.Dr === 0 ? Infinity : v.De / v.Dr;
                    }

                    // B. Calculate AMA (requires F_r and F_e)
                    if (!isNaN(v.Fr) && !isNaN(v.Fe)) {
                        AMA = v.Fe === 0 ? Infinity : v.Fr / v.Fe;
                    }

                    // C. Solve for the Missing Variable 
                    if (missingVariable === 'Eff') {
                        // Case 1: Solve for Efficiency (requires AMA and IMA)
                        if (IMA !== Infinity && IMA !== 0 && !isNaN(AMA)) {
                            calculatedValue = (AMA / IMA) * 100;
                        } else {
                            throw new Error('To calculate Efficiency, $D_e$ and $D_r$ must be provided, and IMA cannot be zero or infinite.');
                        }
                    } else if (missingVariable === 'Fe' || missingVariable === 'Fr') {
                        // Case 2: Solve for a Force
                        if (!isNaN(v.Eff) && !isNaN(IMA) && IMA !== Infinity && IMA !== 0) {
                            // Use Efficieny and IMA to find the required AMA
                            AMA = (v.Eff / 100) * IMA;
                            
                            if (missingVariable === 'Fe') {
                                // Solve for Fe: Fe = Fr / AMA
                                if (AMA === 0) throw new Error('Cannot solve $F_e$: Calculated AMA is zero. Check your efficiency or distance values.');
                                calculatedValue = v.Fr / AMA;
                                v.Fe = calculatedValue; 
                            } else { // missingVariable === 'Fr'
                                // Solve for Fr: Fr = Fe * AMA
                                calculatedValue = v.Fe * AMA;
                                v.Fr = calculatedValue; 
                            }
                        } else if (missingVariable === 'Fe' && !isNaN(v.Fr) && !isNaN(v.De) && !isNaN(v.Dr)) {
                            // If Eff is missing, use work principle
                            if (v.De === 0) throw new Error('Cannot solve $F_e$: Effort Distance is zero.');
                            v.Fe = v.Fr * v.Dr / v.De;
                            AMA = v.Fr / v.Fe;
                            calculatedValue = v.Fe;
                        } else if (missingVariable === 'Fr' && !isNaN(v.Fe) && !isNaN(v.De) && !isNaN(v.Dr)) {
                             // If Eff is missing, use work principle
                            v.Fr = v.Fe * v.De / v.Dr;
                            AMA = v.Fr / v.Fe;
                            calculatedValue = v.Fr;
                        } else {
                             throw new Error('To solve for Force ($F_e$ or $F_r$), you need $\eta$ and IMA (from $D_e, D_r$) OR the other Force and $D_e, D_r$.');
                        }
                    } else if (missingVariable === 'De' || missingVariable === 'Dr') {
                         // Case 3: Solve for a Distance
                        if (!isNaN(v.Eff) && !isNaN(AMA) && AMA !== Infinity) {
                            // Use Efficiency and AMA to find the required IMA
                            if (v.Eff === 0) throw new Error('Cannot solve Distance: Efficiency ($\eta$) cannot be zero.');
                            IMA = AMA / (v.Eff / 100);

                            if (missingVariable === 'De') {
                                // Solve for De: De = IMA * Dr
                                calculatedValue = IMA * v.Dr;
                                v.De = calculatedValue; 
                            } else { // missingVariable === 'Dr'
                                // Solve for Dr: Dr = De / IMA
                                if (IMA === 0) throw new Error('Cannot solve $D_r$: Calculated IMA is zero. Check your efficiency or force values.');
                                calculatedValue = v.De / IMA;
                                v.Dr = calculatedValue; 
                            }
                        } else if (missingVariable === 'De' && !isNaN(v.Fr) && !isNaN(v.Fe) && !isNaN(v.Dr)) {
                            // If Eff is missing, use work principle
                            v.De = v.Fr * v.Dr / v.Fe;
                            IMA = v.De / v.Dr;
                            calculatedValue = v.De;
                        } else if (missingVariable === 'Dr' && !isNaN(v.Fr) && !isNaN(v.Fe) && !isNaN(v.De)) {
                            // If Eff is missing, use work principle
                            if (v.Fr === 0) throw new Error('Cannot solve $D_r$: Resistance Force is zero.');
                            v.Dr = v.Fe * v.De / v.Fr;
                            IMA = v.De / v.Dr;
                            calculatedValue = v.Dr;
                        } else {
                            throw new Error('To solve for Distance ($D_e$ or $D_r$), you need $\eta$ and AMA (from $F_e, F_r$) OR the other Distance and $F_e, F_r$.');
                        }
                    }

                    // --- STEP 3: Final Calculations for Output Fields ---
                    
                    // Final IMA
                    const finalIMA = v.Dr === 0 ? 'Infinite' : (v.De / v.Dr);
                    
                    // Final AMA
                    const finalAMA = v.Fe === 0 ? 'Infinite' : (v.Fr / v.Fe);
                    
                    // Final Efficiency
                    const imaValue = parseFloat(formatResult(finalIMA)) || finalIMA;
                    const amaValue = parseFloat(formatResult(finalAMA)) || finalAMA;
                    let finalEff = '--';
                    if (!isNaN(amaValue) && amaValue !== Infinity && !isNaN(imaValue) && imaValue > 0 && imaValue !== Infinity) {
                        finalEff = ((amaValue / imaValue) * 100).toFixed(2) + ' %';
                    } else if (missingVariable === 'Eff' && !isNaN(calculatedValue)) {
                        finalEff = calculatedValue.toFixed(2) + ' %';
                    }


                    // 4. Display the missing variable result
                    outputsGen.missingName.textContent = outputNamesGen[missingVariable];
                    outputsGen.missingValue.textContent = formatResult(calculatedValue);
                    outputsGen.IMA.textContent = formatResult(finalIMA);
                    outputsGen.AMA.textContent = formatResult(finalAMA);
                    outputsGen.Efficiency.textContent = finalEff;
                    
                    if (finalEff !== '--' && parseFloat(finalEff) > 100) {
                         showMessage(messageBoxGen, `Warning: Calculated efficiency is ${finalEff}. An efficiency greater than 100% indicates that the ideal work principle ($W_{in} \ge W_{out}$) was violated by the input forces/distances.`, false);
                    } else {
                        showMessage(messageBoxGen, `Calculation successful.`, false);
                    }

                } catch (e) {
                    showMessage(messageBoxGen, 'Calculation Error: ' + e.message);
                    return;
                }
            };

            // Event Listeners for General Calculator
            calculateBtnGen.addEventListener('click', calculateGeneral);
            clearBtnGen.addEventListener('click', () => {
                // Clear inputs and outputs
                Object.values(inputsGen).forEach(input => input.value = '');
                clearOutputsGen();
            });

        });
    </script>
</body>
</html>
